{% extends 'Retailer/base.html.twig' %}

{% block title %}Adicionar Cotação{% endblock %}
{% block description %}{% endblock %}
{% block menu_pricelist %} active {% endblock %}

{% block page_plugins %}
    <link href="{{ asset('assets/global/plugins/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css') }}" rel="stylesheet" type="text/css" />
    <link href="{{ asset('assets/global/plugins/datatables/plugins/bootstrap/datatables.bootstrap.css') }}" rel="stylesheet" type="text/css" />

{% endblock %}

{% block page %}

    <style>
        .ProgressBar {
            margin: 0 auto;
          /*  padding: 2em 0 3em;*/
            list-style: none;
            position: relative;
            display: -webkit-box;
            display: -ms-flexbox;
            display: flex;
            -webkit-box-pack: justify;
            -ms-flex-pack: justify;
            justify-content: space-between;
            width: 50% !important;
        }

        .ProgressBar-step {
            text-align: center;
            position: relative;
            width: 100%;
        }
        .ProgressBar-step:before, .ProgressBar-step:after {
            content: "";
            height: 0.2em;
            background-color: #40AE40;;
            position: absolute;
            z-index: 1;
            width: 100%;
            left: -50%;
            top: 50%;
            -webkit-transform: translateY(-50%);
            transform: translateY(-50%);
            -webkit-transition: all .25s ease-out;
            transition: all .25s ease-out;

        }
        .ProgressBar-step:first-child:before, .ProgressBar-step:first-child:after {
            display: none;
        }
        .ProgressBar-step:after {
            background-color: #40AE40;
            border:1px solid #40AE40;
            width: 0;
        }
        .ProgressBar-step.is-complete + .ProgressBar-step.is-current:after, .ProgressBar-step.is-complete + .ProgressBar-step.is-complete:after {
            width: 100%;
        }

        .ProgressBar-icon {
            width: 2.0em;
            height: 2.0em;
            background-color: #319431;
            fill: #319431;
            border-radius: 50%;
            padding: 0.5em;
            max-width: 100%;
            z-index: 10;
            position: relative;
            margin-top: 4px;
            -webkit-transition: all .25s ease-out;
            transition: all .25s ease-out;
            border:2px solid #40AE40
        }
        .is-current .ProgressBar-icon {
            fill: yellow;
            background-color: yellow;
        }
        .is-complete .ProgressBar-icon {
            fill: #fff;
            background-color: #40AE40;
        }

        .ProgressBar-stepLabel {
            display: block;
            text-transform: uppercase;
            color: #9F9FA3;
            position: absolute;
            padding-top: 0.5em;
            width: 100%;
            -webkit-transition: all .25s ease-out;
            transition: all .25s ease-out;
        }
        .is-current > .ProgressBar-stepLabel, .is-complete > .ProgressBar-stepLabel {
            color: #00637C;
        }


        /*
        Float label styles
         */
        label:hover {
            cursor: text;
        }

        @media (max-width: 500px) {
            .contact-form {
                margin: 0 0 100px;
                width: 100%;
            }
        }
        .contact-form .email, .contact-form .message, .contact-form .text {
            position: relative;
        }
        .contact-form .email input:focus, .contact-form .email textarea:focus, .contact-form .message input:focus, .contact-form .message textarea:focus, .contact-form .text input:focus, .contact-form .text textarea:focus {
            background: #f4f5f6;
        }
        .contact-form .email label, .contact-form .message label, .contact-form .text label {
            color: #40AE40;
            left: 23px;
            position: absolute;
            top: 13px;
            -moz-transition: all, 150ms;
            -o-transition: all, 150ms;
            -webkit-transition: all, 150ms;
            transition: all, 150ms;
        }
        .contact-form .email.typing label, .contact-form .message.typing label, .contact-form .text.typing label {
            color: #40ae40;
            font-size: 10px;
            top: 2px;
        }

        .text input, .text select {
            margin: 0 auto;
            height: 44px;
            padding-top: 14px;
            width: 284px;
            border: 1px solid #40AE40
        }
        .text input:focus, .text select:focus{
            border: 1px solid #40AE40;
        }

        .contact-form .email {
            border-left: 1px #e6e6e6 solid;
            float: right;
        }
        @media (max-width: 500px) {
            .contact-form .email {
                border-left: none;
                border-top: 1px #e6e6e6 solid;
            }
        }
        .contact-form .message {
            border-bottom: 1px #e6e6e6 solid;
            border-top: 1px #e6e6e6 solid;
            clear: both;
        }
        .contact-form .message textarea {
            height: 200px;
            padding: 23px;
        }
        .contact-form .text {
            float: left;
        }
        .navbar-inner {
            background: #319431;
            width: 100%;
        }

        #rootwizard{
            background: #fff;
        }

        .wizard-container{
            padding-top: 12px;
            padding-bottom: 15px;
            padding-left: 20px;
            padding-right: 20px;
            border-top-width: 1px;
        }

        .mt-checkbox.mt-checkbox-outline:hover>input:not([disabled]):checked ~ span, .mt-checkbox.mt-checkbox-outline>input:checked ~ span {

            background: #319431 !important;
            border-radius: 2px;
            border: 1px solid #319431;

        }

        .mt-checkbox.mt-checkbox-outline>span {
            border: 1px solid #d9d9d9;
            background: 0;
            border-radius: 2px;
        }
        .mt-checkbox>span:after {
            left: 6px;
            top: 2px;
            width: 5px;
            height: 10px;
            border: solid #fff;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }

        .error {
            border: 1px solid red !important;
        }

        .valid {
            border: 1px solid #40AE40 !important;
        }

        .nav-pills>li.active>a, .nav-pills>li.active>a:hover, .nav-pills>li.active>a:focus {
            color: transparent;
            background-color: transparent;
        }

        .nav>li>a:hover, .nav>li>a:focus {
            text-decoration: none;
            background-color: transparent;
        }
        .disabled-click {
            pointer-events: none;
            cursor: default;
        }
        td {
            text-align: center;
            vertical-align: middle;
        }
        th {
            text-align: center;
            vertical-align: middle;
        }
        .dataTables_filter{

            padding-right: 40px;

        }
        .datatable-plus-button{
            padding-top: 5px;
            top: 14px;
            padding-bottom: 5px;
            padding-right: 9px;
            background: #40AE40;
        }

        .datatable-plus-button::before {
            font-family: fontAwesome;
            content: "\f067\00a0";
            color: white;
            background-color: transparent;
        }

        .text-area{
            width: 284px;
            border: 1px solid #40AE40;
            padding-top: 14px;
            resize: vertical;
        }

        .text select {
            margin: 0 auto;
            height: 44px;
            padding-top: 14px;
            width: 284px;
            border: 1px solid #40AE40
        }
        .text select:focus{
            border: 1px solid #40AE40;
        }
        .modal .modal-header{
            background-color: #40AE40;
        }
        .modal-title{
            color: #FFFFFF;
        }



    </style>

    <div class="page-wrapper-row full-height">
        <div class="page-wrapper-middle">
            <!-- BEGIN CONTAINER -->
            <div class="page-container">
                <!-- BEGIN CONTENT -->
                <div class="page-content-wrapper">
                    <!-- BEGIN CONTENT BODY -->
                    <!-- BEGIN PAGE HEAD-->
                    <div class="page-head">
                        <div class="container">
                            <!-- BEGIN PAGE TITLE -->
                            <div class="page-title">
                                <h1>Cotação
                                    <small>Complete os passos abaixo para crriar a sua cotação</small>
                                </h1>
                            </div>
                            <!-- END PAGE TITLE -->
                        </div>
                    </div>
                    <!-- END PAGE HEAD-->
                    <!-- BEGIN PAGE CONTENT BODY -->
                    <div class="page-content">
                        <div class="container" style="height: 50px;">
                            {% include '_partial/flashMessages.html.twig' %}
                            <!-- BEGIN PAGE BREADCRUMBS -->
                            <ul class="page-breadcrumb breadcrumb">
                                <li>
                                    <a href="{{ path('dashboard') }}">Painel Inicial</a>
                                    <i class="fa fa-circle"></i>
                                </li>
                                <li>
                                    <a href="{{ path('cotacoes') }}">Cotações</a>
                                    <i class="fa fa-circle"></i>
                                </li>
                                <li>
                                    <span>Cotação</span>
                                </li>
                            </ul>
                            <!-- END PAGE BREADCRUMBS -->
                            <!-- BEGIN PAGE CONTENT INNER -->
                            <div class="page-content-inner">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="tabbable-line boxless tabbable-reversed">
                                            <div class="tab-content">
                                                <div class="tab-pane active" id="tab_0">
                                                    <div class="portlet box green-conecta" style="border-left-width: 0px;border-bottom-width: 0px;border-right-width: 0px;">
                                                        <div class="portlet-title">
                                                            <div class="caption">
                                                                <image id="wizardStepImage" ></image><span id="wizardStepLabel">Dados da Cotação</span>
                                                            </div>
                                                        </div>
                                                        <!-- BEGIN WIZARD-->
                                                        <div id="rootwizard">
                                                            <div class="navbar" style="border-top-width: 0px;border-left-width: 0px;border-right-width: 0px;">
                                                                <div class="navbar-inner portlet-title">
                                                                    <div class="container">
                                                                        <ul class="ProgressBar">
                                                                            <li class="ProgressBar-step is-current">
                                                                                <a href="#tab1" class="disabled-click" data-toggle="tab">
                                                                                    <svg class="ProgressBar-icon"><use xlink:href="#checkmark-bold"/></svg>
                                                                                    <span class="ProgressBar-stepLabel"><!--1--></span>
                                                                                </a>
                                                                            </li>
                                                                            <li class="ProgressBar-step" disabled="">
                                                                                <a href="#tab2" class="disabled-click" data-toggle="tab">
                                                                                    <svg class="ProgressBar-icon"><use xlink:href="#checkmark-bold"/></svg>
                                                                                    <span class="ProgressBar-stepLabel"><!--2--></span>
                                                                                </a>
                                                                            </li>
                                                                            <li class="ProgressBar-step">
                                                                                <a href="#tab3" class="disabled-click" data-toggle="tab">
                                                                                    <svg class="ProgressBar-icon"><use xlink:href="#checkmark-bold"/></svg>
                                                                                    <span class="ProgressBar-stepLabel"><!--3--></span>
                                                                                </a>
                                                                            </li>
                                                                            <li class="ProgressBar-step">
                                                                                <a href="#tab4" class="disabled-click" class="disabled-click" data-toggle="tab">
                                                                                    <svg class="ProgressBar-icon"><use xlink:href="#checkmark-bold"/></svg>
                                                                                    <span class="ProgressBar-stepLabel"><!--4--></span>
                                                                                </a>
                                                                            </li>
                                                                            <li class="ProgressBar-step">
                                                                                <a href="#tab5" class="disabled-click" data-toggle="tab">
                                                                                    <svg class="ProgressBar-icon"><use xlink:href="#checkmark-bold"/></svg>
                                                                                    <span class="ProgressBar-stepLabel"><!--5--></span>
                                                                                </a>
                                                                            </li>
                                                                        </ul>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <ul class="pager wizard">
                                                                <li class="previous first" style="display:none;"><a href="#">Início</a></li>
                                                                <li class="previous"   id="previous"><a style="margin-left: 5px;" class="btn btn-circle green-conecta" href="#">Anterior</a></li>
                                                                <li class="next last" style="display:none;"><a href="#">Último</a></li>
                                                                <li class="next" id="advance"><a class="btn btn-circle green-conecta pull-right disabled" href="#" style="margin-right: 5px;margin-bottom: 5px;">Próximo</a></li>
                                                            </ul>

                                                            <div class="tab-content">
                                                                <!-- BEGIN COTACAO STEP-->
                                                                <div class="tab-pane" id="tab1">
                                                                    <div class="portlet-body form">
                                                                        <!-- BEGIN COTACAO FORM-->
                                                                        <form action="#" method="POST" id="cotacao_form" class="form-horizontal contact-form">
                                                                            <div class="form-body ">
                                                                                <div class="row ">
                                                                                    <div class="col-lg-4 col-lg-offset-5">
                                                                                        <div class="">
                                                                                            <div class="form-group cotacao text ">
                                                                                                <label for="cotacao">Nome da Cotação*</label>
                                                                                                <input class="form-control"  name="name" type="text" id="cotacao" required />
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>

                                                                                <div class="row ">
                                                                                    <div class="col-lg-4 col-lg-offset-5">
                                                                                        <div class="">
                                                                                            <div class="form-group datetimepicker1 text ">
                                                                                                <label for="datetimepicker1">Validade de</label>
                                                                                                <input class="form-control " type="text" id="datetimepicker1" name="begins-at" required />
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>

                                                                                <div class="row ">
                                                                                    <div class="col-lg-4 col-lg-offset-5">
                                                                                        <div class="">
                                                                                            <div class="form-group datetimepicker2 text ">
                                                                                                <label for="datetimepicker2">Validade Até</label>
                                                                                                <input class="form-control " type="text" id="datetimepicker2" name="expires-at" required />
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>

                                                                                <div class="row ">
                                                                                    <div class="col-lg-4 col-lg-offset-5">
                                                                                        <div class="">
                                                                                            <div class="form-group text">
                                                                                                <label for="prazo" style='position: initial;'>Prazo de pagamento</label>
                                                                                                {% if userIsRCA %}
                                                                                                <select class='form-control' style='margin-bottom: 3px;' id='prazoRCA' autocomplete="off">
                                                                                                    {% for cond in conditions %}
                                                                                                    <option>{{ cond }}</option>
                                                                                                    {% endfor %}
                                                                                                    <option>Outros</option>
                                                                                                </select>
                                                                                                {% endif %}
                                                                                                <textarea rows="3" class="form-control text-area" type="text" id="prazo" name="payment-date" autocomplete="off" placeholder="Selecionando Outros não é possível fazer um pedido ao Martins"></textarea>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>

                                                                        </form>
                                                                        <!-- END FORM-->
                                                                    </div>

                                                                </div>

                                                                <!-- END COTACAO FORM-->

                                                                <div class="tab-pane " id="tab2">
                                                                    <div class="wizard-container">
                                                                        <table class="table table-striped table-bordered table-hover" id="supplier-datatable">
                                                                            <thead>
                                                                            <tr>
                                                                                <th>Nome do Fornecedor</th>
                                                                                <th>Nome do Representante</th>
                                                                                <th>E-mail</th>
                                                                                <th>CNPJ</th>
                                                                                <th>Telefone</th>
                                                                                <th name="removeSort" class="no-sort"><label class="mt-checkbox mt-checkbox-outline"/>  <input name="selectAllSupplier" type="checkbox"   /> <span></span></th>

                                                                            </tr>
                                                                            </thead>
                                                                            <tbody>
                                                                            {% if suppliers is defined %}
                                                                                {% for supplier in suppliers %}
                                                                                    {% for representative in supplier.representatives if representative.deleted == 0 %}
                                                                                        <tr>
                                                                                            <td> {{ supplier.name }} </td>
                                                                                            <td> {{ representative.name }} </td>
                                                                                            <td class="numeric"> {{ representative.email }} </td>
                                                                                            <td class="numeric"> {{ supplier.cnpj }} </td>
                                                                                            <td class="numeric"> {{ representative.phone }} </td>
                                                                                            <td>
                                                                                                <label class="mt-checkbox mt-checkbox-outline"/>  <input type="checkbox" name="chkSupplier" value="{{ supplier.id }}"  /> <span></span>
                                                                                            </td>

                                                                                        </tr>
                                                                                    {% endfor %}
                                                                                {% endfor %}
                                                                            {% endif %}

                                                                            </tbody>
                                                                        </table>

                                                                    </div>





                                                                    <!-- Supplier Modal -->
                                                                    <div id="myModal" class="modal fade" role="dialog">
                                                                        <div class="modal-dialog">

                                                                            <!-- Modal content-->
                                                                            <div class="modal-content">
                                                                                <div class="modal-header">
                                                                                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                                                    <h4 class="modal-title">Adicionar Fornecedor</h4>
                                                                                </div>
                                                                                <div class="modal-body">


                                                                                    <form action="#" method="POST" id="supplier_form" class="form-horizontal contact-form">


                                                                                        <div class="form-body ">

                                                                                            <div class="row ">

                                                                                                <div class="col-lg-4 col-lg-offset-3">
                                                                                                    <div class="">
                                                                                                        <div class="form-group fornecedor text ">
                                                                                                            <label for="fornecedor">Fornecedor*</label>
                                                                                                            <input class="form-control" type="text" name="fornecedor" id="fornecedor" required />
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>

                                                                                            </div>

                                                                                            <div class="row ">
                                                                                                <div class="col-lg-4 col-lg-offset-3">
                                                                                                    <div class="">
                                                                                                        <div class="form-group cnpj text ">
                                                                                                            <label for="cnpj">CNPJ*</label>
                                                                                                            <input class="form-control" type="text" name="cnpj" id="cnpj" required />
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>

                                                                                            <div class="row ">

                                                                                                <div class="col-lg-4 col-lg-offset-3">
                                                                                                    <div class="">
                                                                                                        <div class="form-group valor_minimo text ">
                                                                                                            <label for="valor_minimo">Pedido Mínimo</label>
                                                                                                            <input class="form-control" type="text" id="valor_minimo"   />
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>

                                                                                            </div>

                                                                                            <div class="row ">

                                                                                                <div class="col-lg-4 col-lg-offset-3">
                                                                                                    <div class="">
                                                                                                        <div class="form-group representante text ">
                                                                                                            <label for="representante">Nome do Representante*</label>
                                                                                                            <input class="form-control" type="text" name="representante" id="representante" required/>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>

                                                                                            </div>

                                                                                            <div class="row ">

                                                                                                <div class="col-lg-4 col-lg-offset-3">
                                                                                                    <div class="">
                                                                                                        <div class="form-group email_representante text ">
                                                                                                            <label for="email_representante">E-Mail do Representate*</label>
                                                                                                            <input class="form-control" type="text" name="email_representante" id="email_representante" required/>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>

                                                                                            </div>


                                                                                            <div class="row ">

                                                                                                <div class="col-lg-4 col-lg-offset-3">
                                                                                                    <div class="">
                                                                                                        <div class="form-group telefone_representante text ">
                                                                                                            <label for="telefone_representante">Telefone do Representante</label>
                                                                                                            <input class="form-control" type="text"  id="telefone_representante"   />
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>

                                                                                            </div>

                                                                                        </div>

                                                                                        <!--
                                                                                        <div class="form-actions">
                                                                                            <div class="row">
                                                                                                <div class="col-md-offset-3 col-md-9">
                                                                                                    <button type="submit" class="btn btn-circle green-conecta">Salvar</button>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                        -->


                                                                                    </form>



                                                                                </div>
                                                                                <div class="modal-footer">
                                                                                    <button type="button"  id="salvar_fornecedor" data-loading-text="<i class='fa fa-circle-o-notch fa-spin'></i> Salvando Fornecedor" class="btn green-conecta btn-circle" data-style="expand-right">
                                                                                    Salvar
                                                                                    </button>

                                                                                </div>
                                                                            </div>

                                                                        </div>
                                                                    </div>





                                                                </div>

                                                                <div class="tab-pane" id="tab3">
                                                                    <div class="wizard-container">
                                                                        <table class="table table-striped table-bordered table-hover" id="listing-datatable">
                                                                            <thead>
                                                                            <tr>
                                                                                <th width="20%"> Nome </th>
                                                                                <th> Descrição </th>
                                                                                <th> Tipo </th>
                                                                                <th> Itens </th>
                                                                                <th name="removeSort" class="no-sort"><label class="mt-checkbox mt-checkbox-outline"/>  <input name="selectAllListing" type="checkbox" name="test" /> <span></span></th>
                                                                            </tr>
                                                                            </thead>
                                                                            <tbody>

                                                                            {% if listings is defined %}
                                                                                {% for listing in listings %}
                                                                                    <tr>
                                                                                        <input type="hidden" value="{{ listing.id }}">
                                                                                        <td width="20%">{{ listing.name }}</td>
                                                                                        <td >{{ listing.description }}</td>
                                                                                        <td>{{ types[listing.type] }}</td>
                                                                                        <td>{{ listing.listingProducts|length }}</td>
                                                                                        <td>
                                                                                            <label class="mt-checkbox mt-checkbox-outline"/>  <input type="checkbox" value="{{ listing.id }}" name="chkListing" /> <span></span>
                                                                                        </td>
                                                                                    </tr>
                                                                                {% endfor %}
                                                                            {% endif %}
                                                                            </tbody>
                                                                        </table>



                                                                        <!-- LISTING Modal -->
                                                                        <div id="listingModal" class="modal fade" role="dialog">
                                                                            <div class="modal-dialog">

                                                                                <!-- Modal content-->
                                                                                <div class="modal-content">
                                                                                    <div class="modal-header">
                                                                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                                                        <h4 class="modal-title">Adicionar Lista</h4>
                                                                                    </div>
                                                                                    <div class="modal-body">


                                                                                        <form action="#" method="POST" id="list_form" class="form-horizontal contact-form">


                                                                                            <div class="form-body ">

                                                                                                <div class="row ">

                                                                                                    <div class="col-lg-4 col-lg-offset-3">
                                                                                                        <div class="">
                                                                                                            <div class="form-group lista text ">
                                                                                                                <label for="lista">Lista*</label>
                                                                                                                <input class="form-control" type="text" name="lista" id="lista" required />
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>

                                                                                                </div>

                                                                                                <div class="row ">
                                                                                                    <div class="col-lg-4 col-lg-offset-3">
                                                                                                        <div class="">
                                                                                                            <div class="form-group descricao text ">
                                                                                                                <label for="descricao">Descrição*</label>
                                                                                                                <input class="form-control" type="text" name="descricao" id="descricao" required/>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>

                                                                                                <div class="row ">

                                                                                                    <div class="col-lg-4 col-lg-offset-3">
                                                                                                        <div class="">
                                                                                                            <div class="form-group tipo text typing">
                                                                                                                <label for="tipo">Tipo*</label>
                                                                                                                <select name="tipo" id="tipo" class="form-control select-circle " required>
                                                                                                                    {% for type in types %}
                                                                                                                        <option value="{{ loop.index0 }}">{{ type }}</option>
                                                                                                                    {% endfor %}
                                                                                                                </select>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>

                                                                                                </div>



                                                                                            </div>

                                                                                            <!--
                                                                                            <div class="form-actions">
                                                                                                <div class="row">
                                                                                                    <div class="col-md-offset-3 col-md-9">
                                                                                                        <button type="submit" class="btn btn-circle green-conecta">Salvar</button>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                            -->


                                                                                        </form>



                                                                                    </div>
                                                                                    <div class="modal-footer">
                                                                                        <button type="button"  id="salvar_lista" data-loading-text="<i class='fa fa-circle-o-notch fa-spin'></i> Salvando Lista" class="btn green-conecta btn-circle" data-style="expand-right">
                                                                                            Salvar
                                                                                        </button>

                                                                                    </div>
                                                                                </div>

                                                                            </div>
                                                                        </div>



                                                                    </div>
                                                                </div>

                                                                <div class="tab-pane" id="tab4">
                                                                    <div class="wizard-container">
                                                                        <table class="table table-striped table-bordered table-hover" id="product-datatable">
                                                                            <thead>
                                                                            <tr>
                                                                                <th width="20%"> Código </th>
                                                                                <th> Nome do Produto </th>
                                                                                <th> Tipo </th>
                                                                                <th> Fabricante </th>
                                                                                <th> Embalagem de Compra </th>
                                                                                <th><label class="mt-checkbox mt-checkbox-outline"/>  <input  type="checkbox"  name="selectAllProducts" /> <span></span></th>
                                                                            </tr>
                                                                            </thead>
                                                                            <tbody>
                                                                            {% if products is defined %}
                                                                            {% for product in products %}
                                                                                <tr>
                                                                                    <td> {{ product.id }} </td>
                                                                                    <td> {{ product.name }} </td>
                                                                                    <td> {{ product.type }} </td>
                                                                                    <td> {{ product.brand }} </td>
                                                                                    <td> {{ product.unit }} {{ product.quantity }} </td>
                                                                                    <td>
                                                                                        <label class="mt-checkbox mt-checkbox-outline"/>  <input type="checkbox" value="{{ product.id }}" name="chkProducts" /> <span></span>
                                                                                    </td>

                                                                                </tr>
                                                                            {% endfor %}
                                                                            {% endif %}
                                                                            </tbody>
                                                                        </table>


                                                                        <!-- LISTING Modal -->
                                                                        <div id="productModal" class="modal fade" role="dialog">
                                                                            <div class="modal-dialog">

                                                                                <!-- Modal content-->
                                                                                <div class="modal-content">
                                                                                    <div class="modal-header">
                                                                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                                                                        <h4 class="modal-title">Adicionar Produto</h4>
                                                                                    </div>
                                                                                    <div class="modal-body">


                                                                                        <form action="#" method="POST" id="product_form" class="form-horizontal contact-form">


                                                                                            <div class="form-body ">

                                                                                                <div class="row ">

                                                                                                    <div class="col-lg-4 col-lg-offset-3">
                                                                                                        <div class="">
                                                                                                            <div class="form-group produto text ">
                                                                                                                <label for="produto">Nome do Produto*</label>
                                                                                                                <input class="form-control" type="text" name="produto" id="produto" required />
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>

                                                                                                </div>

                                                                                                <div class="row ">
                                                                                                    <div class="col-lg-4 col-lg-offset-3">
                                                                                                        <div class="">
                                                                                                            <div class="form-group codigo text ">
                                                                                                                <label for="codigo">Código de Barras do Produto*</label>
                                                                                                                <input class="form-control" type="text" name="codigo" id="codigo" required/>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>

                                                                                                <div class="row ">
                                                                                                    <div class="col-lg-4 col-lg-offset-3">
                                                                                                        <div class="">
                                                                                                            <div class="form-group marca text ">
                                                                                                                <label for="marca">Marca do Produto*</label>
                                                                                                                <input class="form-control" type="text" name="marca" id="marca" required/>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>

                                                                                                <div class="row ">

                                                                                                    <div class="col-lg-4 col-lg-offset-3">
                                                                                                        <div class="">
                                                                                                            <div class="form-group tipo text typing">
                                                                                                                <label for="tipo-produto">Tipo*</label>
                                                                                                                <select name="tipo-produto" id="tipo-produto"  class="form-control select-circle " required>
                                                                                                                    {% if product is defined %}
                                                                                                                        <option value="{{ product.type }}" selected>{{ product.type }}</option>
                                                                                                                    {% else %}
                                                                                                                        <option value="" disabled selected>Selecione um Tipo</option>
                                                                                                                    {% endif %}
                                                                                                                    <option value="Geral">Geral</option>
                                                                                                                    <option value="Mercearia">Mercearia</option>
                                                                                                                    <option value="Limpeza">Limpeza</option>
                                                                                                                    <option value="Perfumaria">Perfumaria</option>
                                                                                                                    <option value="Bazar">Bazar</option>
                                                                                                                    <option value="Bebidas">Bebidas</option>
                                                                                                                    <option value="Eletro">Eletro</option>
                                                                                                                    <option value="Perecíveis">Perecíveis</option>
                                                                                                                    <option value="Rotisseria">Rotisseria</option>
                                                                                                                    <option value="Textil">Textil</option>
                                                                                                                    <option value="Açougue">Açougue</option>
                                                                                                                    <option value="Hortifruti">Hortifruti</option>
                                                                                                                    <option value="Padaria">Padaria</option>
                                                                                                                    <option value="Insumos De Producao">Insumos de Produção</option>
                                                                                                                    <option value="Materiais Para Uso">Materiais para Uso</option>
                                                                                                                </select>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>

                                                                                                </div>

                                                                                                <div class="row ">

                                                                                                    <div class="col-lg-4 col-lg-offset-3">
                                                                                                        <div class="">
                                                                                                            <div class="form-group unidade text typing">
                                                                                                                <label for="tipo-produto">Unidade de Medida*</label>
                                                                                                                <select name="unidade" id="unidade"  class="form-control select-circle " required>
                                                                                                                    {% if product is defined %}
                                                                                                                        <option value="{{ product.unit }}" selected>{{ product.unit }}</option>
                                                                                                                    {% else %}
                                                                                                                        <option value="" disabled selected>Selecione uma Unidade de Medida</option>
                                                                                                                    {% endif %}
                                                                                                                    <option value="Unidade">Unidade</option>
                                                                                                                    <option value="Caixa">Caixa</option>
                                                                                                                    <option value="Kg">Kg</option>
                                                                                                                    <option value="Litro">Litro</option>
                                                                                                                    <option value="Fardo">Fardo</option>
                                                                                                                    <option value="Pacote">Pacote</option>
                                                                                                                    <option value="Pack">Pack</option>
                                                                                                                </select>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>

                                                                                                </div>



                                                                                                <div class="row ">
                                                                                                    <div class="col-lg-4 col-lg-offset-3">
                                                                                                        <div class="">
                                                                                                            <div class="form-group peso text ">
                                                                                                                <label for="peso">Peso / Quantidade*</label>
                                                                                                                <input class="form-control" type="text" name="peso" id="peso" required/>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                </div>

                                                                                                <div class="row ">

                                                                                                    <div class="col-lg-4 col-lg-offset-3">
                                                                                                        <div class="">
                                                                                                            <div class="form-group descricao-produto text ">
                                                                                                                <label for="descricao-produto">Descrição Completa*</label>
                                                                                                                <textarea rows="3" class="form-control text-area" type="text" id="descricao-produto" name="descricao-produto"  >
                                                                                                                </textarea>
                                                                                                            </div>
                                                                                                        </div>
                                                                                                    </div>

                                                                                                </div>




                                                                                            </div>

                                                                                            <!--
                                                                                            <div class="form-actions">
                                                                                                <div class="row">
                                                                                                    <div class="col-md-offset-3 col-md-9">
                                                                                                        <button type="submit" class="btn btn-circle green-conecta">Salvar</button>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                            -->


                                                                                        </form>



                                                                                    </div>
                                                                                    <div class="modal-footer">
                                                                                        <button type="button"  id="salvar_produto" data-loading-text="<i class='fa fa-circle-o-notch fa-spin'></i> Salvando Produto" class="btn green-conecta btn-circle" data-style="expand-right">
                                                                                            Salvar
                                                                                        </button>

                                                                                    </div>
                                                                                </div>

                                                                            </div>
                                                                        </div>


                                                                    </div>
                                                                </div>

                                                                <div class="tab-pane" id="tab5">
                                                                    <div class="wizard-container">
                                                                        <div class="row">
                                                                            <div class="col-md-6">
                                                                                <h2>
                                                                                    Dados da Cotação
                                                                                </h2>
                                                                                <h4>
                                                                                    Início
                                                                                </h4>
                                                                                <div class='row'>
                                                                                    <div class="col-md-3">
                                                                                        <i class="fa fa-calendar" aria-hidden="true" ></i>
                                                                                        <span id="quote_start"> data</span>
                                                                                    </div>

                                                                                    <div class="col-md-3">
                                                                                        <i class="fa fa-calendar" aria-hidden="true"></i>
                                                                                        <span id="quote_start_time"> hora</span>
                                                                                    </div>
                                                                                </div>
                                                                                <h4>
                                                                                    Fim
                                                                                </h4>
                                                                                <div class='row'>
                                                                                    <div class="col-md-3">
                                                                                        <i class="fa fa-calendar" aria-hidden="true"></i><span id="quote_end"> data</span>
                                                                                    </div>

                                                                                    <div class="col-md-3">
                                                                                        <i class="fa fa-calendar" aria-hidden="true"></i><span id="quote_end_time"> hora</span>
                                                                                    </div>
                                                                                </div>
                                                                                <div class='row'>
                                                                                    <div class="col-md-3">
                                                                                        <i class="fa fa-calendar" aria-hidden="true"></i><span > Itens</span>
                                                                                        <span id="quote_itens"></span>
                                                                                    </div>

                                                                                    <div class="col-md-4">
                                                                                        <i class="fa fa-calendar" aria-hidden="true"></i>
                                                                                        <span> Fornecedores</span>
                                                                                        <span id="quote_suppliers"></span>
                                                                                    </div>
                                                                                </div>
                                                                                <h4>
                                                                                    Prazo de Pagamento
                                                                                </h4>
                                                                                <div class='row'>
                                                                                    <div class="col-md-3">
                                                                                        <span id="quote_due_date"></span>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-md-6" style="margin-top: 50px;margin-left: 0px;padding-left: 110px;">
                                                                                <button  class="btn col-md-6 green-conecta">Salvar Cotação</button><br/>
                                                                                <button  class="btn col-md-6 green-conecta">Iniciar Cotação Presencial</button><br/>
                                                                                <button  class="btn col-md-6 green-conecta">Enviar Para Fornecedor</button>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!-- END WIZARD-->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>
                            <!-- END PAGE CONTENT INNER -->
                        </div>
                    </div>
                    <!-- END PAGE CONTENT BODY -->
                    <!-- END CONTENT BODY -->
                </div>
                <!-- END CONTENT -->
            </div>
            <!-- END CONTAINER -->
        </div>
    </div>

    <svg style="display:none" xmlns="http://www.w3.org/2000/svg">
        <symbol id="checkmark-bold" viewBox="0 0 24 24">
            <path d="M20.285 2l-11.285 11.567-5.286-5.011-3.714 3.716 9 8.728 15-15.285z"/>
        </symbol>
    </svg>
{% endblock %}

{% block script %}
    <script src="{{ asset('assets/global/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/global/plugins/bootstrap-datetimepicker/js/locales/bootstrap-datetimepicker.pt-BR.js') }}" type="text/javascript" charset="UTF-8"></script>
    <script src="{{ asset('assets/global/plugins/bootstrap-wizard/jquery.bootstrap.wizard.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/global/scripts/datatable.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/global/plugins/datatables/datatables.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/global/plugins/jquery-validation/js/jquery.validate.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/global/plugins/jquery-validation/js/localization/messages_pt_BR.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset('assets/pages/scripts/jquery.mask.min.js') }}" type="text/javascript"></script>


    <script>





    //BEGIN MASKS

        $(function(){
            $('#cnpj').mask('00.000.000/0000-00');
            $('#valor_minimo').mask('000.000.000.000.000,00', {reverse: true});
        });

    var SPMaskBehavior = function (val) {
            return val.replace(/\D/g, '').length === 11 ? '(00) 00000-0000' : '(00) 0000-00009';
        },
        spOptions = {
            onKeyPress: function(val, e, field, options) {
                field.mask(SPMaskBehavior.apply({}, arguments), options);
            }
        };

    $('#telefone_representante').mask(SPMaskBehavior, spOptions);

        //END MASKS


        var token = "{{ token }}";

{% if userIsRCA %}
$("#prazo").hide();
$("#prazoRCA").change(function() {
    if($(this).val() == "Outros")
        $('#prazo').show();
    else
        $('#prazo').hide();
});
{% endif %}

        $(function () {
            $('#datetimepicker1').datetimepicker({
                format: 'dd/mm/yyyy hh:ii',
                language: 'pt-BR'
            });
            $('#datetimepicker2').datetimepicker({
                format: 'dd/mm/yyyy hh:ii',
                language: 'pt-BR'
            });
        });

        function setItensSuplliers(id,elementId) {
            var count = 0;

            $.each($("#" + id + " tr").find("input"), function( index, value ) {
                if ( $(this)["0"].checked ){
                    count = count + 1
                };
            });
            $("#" + elementId ).text(count);
        }

        function setDateTime(id,elementId,format){
            var formatted;
            var date = $("#"+id).data("datetimepicker").getDate();

            if (format === "date") {
                formatted = " " +  date.getDate() + "/" +(date.getMonth() + 1) + "/" +  date.getFullYear();
            } else {
                formatted = " " +   date.getHours() + ":" + date.getMinutes() ;
            }

            $("#" + elementId ).text(formatted);
        }

        function stepFoward($bar) {
            if ($bar.children(".is-current").length > 0) {
                $bar.children(".is-current").removeClass("is-current").addClass("is-complete").next().addClass("is-current");
            } else {
                $bar.children().first().addClass("is-current");
            }
        }

        function selectAll(topCheck,checks) {
            $("[name='" + topCheck + "']").click(function() {
                var checkBoxes = $("[name='" + checks + "']");
                checkBoxes.prop("checked", !checkBoxes.prop("checked"));
            })
        }

        $(document).ready(function() {
            //BEGIN WIZARD METHODS
            $('#rootwizard').bootstrapWizard({onTabShow: function(tab, navigation, index) {
                var currentStep = navigation.find('li');
                currentStep.removeClass("active");

                switch(index) {
                    case 0 :
                        $("#wizardStepLabel").text(" Dados da Cotação");
                        $("#wizardStepImage").attr("src","{{ asset('assets/global/img/icons/dados-da-cotacao/24x24.png') }}")
                        $("#advance a").addClass('disabled');
                        $("#previous").hide();

                        //BEGIN FORM VALIDATION
                        var cotacaoForm = $( "#cotacao_form" );

                        cotacaoForm.validate({
                            errorPlacement: function(){
                                return false;
                            }
                        });

                        cotacaoForm.mouseout(function() {
                            var validationState = $('#cotacao_form').valid();

                            if(validationState) {
                                $("#advance").find("a").removeClass('disabled');
                            }
                        });

                        if($('#cotacao_form').valid()) {
                            $("#advance").find("a").removeClass('disabled');
                        }
                        //END FORM VALIDATION
                        break;
                    case 1 :
                        $("#wizardStepLabel").text(" Selecionar Fornecedor");
                        $("#wizardStepImage").attr("src","{{ asset('assets/global/img/icons/fornecedores/24x24.png') }}")
                        $("#advance a").addClass('disabled');
                        $("#previous").show();

                        var representativeTable = $('#representative-datatable');

                        representativeTable.mouseout(function() {
                            if( representativeTable.find('tr').find("input").is(":checked") ){
                                $("#advance").find("a").removeClass('disabled');
                            }
                        });

                        break;
                    case 2 :
                        $("#wizardStepLabel").text(" Selecionar Lista");
                        $("#wizardStepImage").attr("src","{{ asset('assets/global/img/icons/minhas-listas/24x24.png') }}")
                        $("#advance a").addClass('disabled');

                        var listingTable = $('#listing-datatable');

                        listingTable.mouseout(function() {
                            if( listingTable.find('tr').find("input").is(":checked") ) {
                                $("#advance").find("a").removeClass('disabled');
                            }
                        });

                        break;
                    case 3 :
                        $("#wizardStepLabel").text(" Selecionar Produtos");
                        $("#wizardStepImage").attr("src","{{ asset('assets/global/img/icons/produtos/24x24.png') }}")
                        $("#advance a").addClass('disabled');
                        $("#advance").show();

                        var productTable = $('#product-datatable');

                        productTable.mouseout(function() {
                            if( productTable.find('tr').find("input").is(":checked") ){
                                $("#advance").find("a").removeClass('disabled');
                            }
                        });

                        break;
                    case 4 :
                        $("#wizardStepLabel").text(" Confirmação dos Dados");
                        $("#wizardStepImage").attr("src","{{ asset('assets/global/img/icons/confirmacao-dos-dados/24x24.png') }}")
                        $("#advance").hide();
                        setDateTime("datetimepicker1","quote_start","date");
                        setDateTime("datetimepicker1","quote_start_time","time");
                        setDateTime("datetimepicker2","quote_end","date");
                        setDateTime("datetimepicker2","quote_end_time","time");
                        setItensSuplliers("product-datatable","quote_itens");
                        setItensSuplliers("representative-datatable","quote_suppliers");
                        if($('#prazoRCA').length && $('#prazoRCA').val() != 'Outros') {
                            $('#quote_due_date').text($('#prazoRCA').val());
                        } else {
                            $('#quote_due_date').text($('#prazo').val());
                        }
                        break;
                }
            }});
        });

        $("#advance").on("click", function() {
            var $bar = $(".ProgressBar");
            stepFoward($bar);
        });

        $("#previous").on("click", function() {
            var $bar = $(".ProgressBar");
            if ($bar.children(".is-current").length > 0) {
                $bar.children(".is-current").removeClass("is-current").prev().removeClass("is-complete").addClass("is-current");
            } else {
                $bar.children(".is-complete").last().removeClass("is-complete").addClass("is-current");
            }
        });

        //END WIZARD METHODS

        $('#datetimepicker1').change(function(){
            $('.datetimepicker1.text').addClass('typing');
            if( $(this).val().length == 0 ) {
                $('.datetimepicker1.text').removeClass('typing');
            }
        });

        $('#datetimepicker1').datetimepicker(
            'setDate', (new Date()),
            {format: 'dd/mm/yyyy hh:ii'}
        );
        $('.datetimepicker1.text').addClass('typing');

        $('#datetimepicker2').change(function(){
            $('.datetimepicker2.text').addClass('typing');
            if( $(this).val().length == 0 ) {
                $('.datetimepicker2.text').removeClass('typing');
            }
        });

        //cotacao field default value
        var d = new Date();

        var month = d.getMonth()+1;
        var day = d.getDate();
        var hours = d.getHours()
        var minutes = d.getMinutes()

        var output = "Cotação " + ((''+day).length<2 ? '0' : '') + day + '/' +
            ((''+month).length<2 ? '0' : '') + month + ", " +
            hours + ":" + minutes;

        $("#cotacao").val(output);
        $('.cotacao.text').addClass('typing');

        //BEGIN FLOAT LABEL METHODS
        $('#cotacao').keyup(function(){
            $('.cotacao.text').addClass('typing');
            if( $(this).val().length == 0 ) {
                $('.cotacao.text').removeClass('typing');
            }
        });

        $('#prazo').keyup(function(){
            $('.prazo.text').addClass('typing');
            if( $(this).val().length == 0 ) {
                $('.prazo.text').removeClass('typing');
            }
        });

        $('#fornecedor').keyup(function(){
            $('.fornecedor.text').addClass('typing');
            if( $(this).val().length == 0 ) {
                $('.fornecedor.text').removeClass('typing');
            }
        })

        $('#cnpj').keyup(function(){
            $('.cnpj.text').addClass('typing');
            if( $(this).val().length == 0 ) {
                $('.cnpj.text').removeClass('typing');
            }
        })

        $('#valor_minimo').keyup(function(){
            $('.valor_minimo.text').addClass('typing');
            if( $(this).val().length == 0 ) {
                $('.valor_minimo.text').removeClass('typing');
            }
        })



        $('#representante').keyup(function(){
            $('.representante.text').addClass('typing');
            if( $(this).val().length == 0 ) {
                $('.representante.text').removeClass('typing');
            }
        })

        $('#email_representante').keyup(function(){
            $('.email_representante.text').addClass('typing');
            if( $(this).val().length == 0 ) {
                $('.email_representante.text').removeClass('typing');
            }
        })

        $('#telefone_representante').keyup(function(){
            $('.telefone_representante.text').addClass('typing');
            if( $(this).val().length == 0 ) {
                $('.telefone_representante.text').removeClass('typing');
            }
        })

        $('#lista').keyup(function(){
            $('.lista.text').addClass('typing');
            if( $(this).val().length == 0 ) {
                $('.lista.text').removeClass('typing');
            }
        })

        $('#descricao').keyup(function(){
            $('.descricao.text').addClass('typing');
            if( $(this).val().length == 0 ) {
                $('.descricao.text').removeClass('typing');
            }
        })

        $('#tipo').keyup(function(){
            $('.tipo.text').addClass('typing');
            if( $(this).val().length == 0 ) {
                $('.tipo.text').removeClass('typing');
            }
        })

        $('#produto').keyup(function(){
            $('.produto.text').addClass('typing');
            if( $(this).val().length == 0 ) {
                $('.produto.text').removeClass('typing');
            }
        })

        $('#codigo').keyup(function(){
            $('.codigo.text').addClass('typing');
            if( $(this).val().length == 0 ) {
                $('.codigo.text').removeClass('typing');
            }
        })

        $('#marca').keyup(function(){
            $('.marca.text').addClass('typing');
            if( $(this).val().length == 0 ) {
                $('.marca.text').removeClass('typing');
            }
        })

        $('#peso').keyup(function(){
            $('.peso.text').addClass('typing');
            if( $(this).val().length == 0 ) {
                $('.peso.text').removeClass('typing');
            }
        })

        $('#descricao-produto').keyup(function(){
            $('.descricao-produto.text').addClass('typing');
            if( $(this).val().length == 0 ) {
                $('.descricao-produto.text').removeClass('typing');
            }
        })







        //END FLOAT LABEL METHODS


        // BEGIN Supplier TABLE
        $('#supplier-datatable').dataTable( {
            language: {


        "sEmptyTable": "Nenhum registro encontrado",
        "sInfo": "Mostrando de _START_ até _END_ de _TOTAL_ registros",
        "sInfoEmpty": "Mostrando 0 até 0 de 0 registros",
        "sInfoFiltered": "(Filtrados de _MAX_ registros)",
        "sInfoPostFix": "",
        "sInfoThousands": ".",
        "sLengthMenu": "_MENU_ resultados por página",
        "sLoadingRecords": "Carregando...",
        "sProcessing": "Processando...",
        "sZeroRecords": "Nenhum registro encontrado",
        "sSearch": "Pesquisar",
        "oPaginate": {
        "sNext": '<i class="fa fa-angle-right"></i>',
            "sPrevious": '<i class="fa fa-angle-left"></i>',

    },
        "oAria": {
        "sSortAscending": ": Ordenar colunas de forma ascendente",
            "sSortDescending": ": Ordenar colunas de forma descendente"
    }
    },

            ajax: {
                url: "/api/representative",
                type: 'GET',
                dataSrc: "",
                beforeSend : function(xhr) {
                    xhr.setRequestHeader('Api-Token', token);
                }
            },
            columns: [
                { "data": "name" },
                { "data": "contact_name" },
                { "data": "contact_email" },
                { "data": "cnpj"},
                { "data": "contact_email"},
                { "data": "id",
                    "orderable": false ,
                    "className": "dt-center",
                    "render": function ( data, type, row ) {
                        return ' <label class="mt-checkbox mt-checkbox-outline"/>  <input type="checkbox" name="chkRepresentative" value="' + data + '"  /> <span></span>'
                    }
                }
            ],
            dom: '<"top"<"pull-left"l><"pull-right"fB>>t<"bottom"ip><"clear">',

             buttons: [
             {
             text: '',
             className: 'datatable-plus-button add-supplier green-conecta',
                  action: function ( e, dt, node, config ) {

                      $('#myModal').modal('toggle');

                 }

             }
             ],
            initComplete: function(){



            }


        } );


        $('#salvar_fornecedor').on('click', function() {



            var $this = $(this);

            var name = $('#fornecedor').val();
            var cnpj = $('#cnpj').val();

            var minimum_value = null;

            if($('#valor_minimo').val() !== ""){
                minimum_value = $('#valor_minimo').val()
            }

            var contact_name = $('#representante').val();
            var contact_phone = $('#telefone_representante').val()
            var contact_email = $('#email_representante').val();

            $this.button('loading');
            var supplierForm = $( "#supplier_form" );

            $( "#supplier_form" ).validate({
                errorPlacement: function(){
                    return false;
                }


            });
            var validationState = supplierForm.valid();

            if(validationState) {

                $.ajax(
                    {
                        url: '/api/representative',
                        type: 'POST',
                        contentType: "application/json",
                        dataType: "json",
                        headers: {'Api-Token': token},
                        data:  JSON.stringify({
                            name: name,
                            cnpj: cnpj,
                            minimum_value: minimum_value,
                            contact_name: contact_name,
                            contact_phone: contact_phone,
                            contact_email: contact_email
                        }),
                        success: function (response) {
                            console.log(response);
                            $('#supplier-datatable').DataTable().ajax.reload()
                            $this.button('reset');
                            $('#myModal').modal('toggle');
                            $("#supplier_form").trigger("reset")
                        },
                        error: function (error) {
                            alert(error.responseJSON.error.exception["0"].message);
                            $this.button('reset');
                            $('#myModal').modal('toggle');
                            $("#supplier_form").trigger("reset")
                        }

                    }).done(function () {
                    $this.button('reset');
                });
            }else{
                $this.button('reset');
            }

        });

        //select all function
        selectAll("selectAllSupplier","chkSupplier");




        // END Supplier TABLE




        // BEGIN LISTING TABLE
        $('#listing-datatable').dataTable({
            language: {


                "sEmptyTable": "Nenhum registro encontrado",
                "sInfo": "Mostrando de _START_ até _END_ de _TOTAL_ registros",
                "sInfoEmpty": "Mostrando 0 até 0 de 0 registros",
                "sInfoFiltered": "(Filtrados de _MAX_ registros)",
                "sInfoPostFix": "",
                "sInfoThousands": ".",
                "sLengthMenu": "_MENU_ resultados por página",
                "sLoadingRecords": "Carregando...",
                "sProcessing": "Processando...",
                "sZeroRecords": "Nenhum registro encontrado",
                "sSearch": "Pesquisar",
                "oPaginate": {
                    "sNext": '<i class="fa fa-angle-right"></i>',
                    "sPrevious": '<i class="fa fa-angle-left"></i>',

                },
                "oAria": {
                    "sSortAscending": ": Ordenar colunas de forma ascendente",
                    "sSortDescending": ": Ordenar colunas de forma descendente"
                }
            },
            ajax: {
                url: "/api/listing",
                type: 'GET',
                dataSrc: "",
                beforeSend : function(xhr) {
                    xhr.setRequestHeader('Api-Token', token);
                }
            },
            columns: [
                { "data": "name" },
                { "data": "description" },
                { "data": "type" },
                { "data": "listing_products",
                    "render": function ( data, type, row ) {
                        return data.length;
                    }
                },
                {
                    "data": "id",
                    "orderable": false ,
                    "className": "dt-center",
                    "render": function ( data, type, row ) {
                        return '<label class="mt-checkbox mt-checkbox-outline"/>  <input type="checkbox" name="chkListing" value="' + data + '"  /> <span></span>';
                    }
                }

            ],
            dom: '<"top"<"pull-left"l><"pull-right"fB>>t<"bottom"ip><"clear">',
            buttons: [
                {
                    text: '',
                    className: 'datatable-plus-button ',
                     action: function ( e, dt, node, config ) {
                         $('#listingModal').modal('toggle');
                    }
                }
            ]
        } );

        $('#salvar_lista').on('click', function() {

            /*
             listingModal
             lista
             descricao
             tipo

             */

            var $this = $(this);

            var lista = $('#lista').val();
            var descricao = $('#descricao').val();
            var tipo = $('#tipo').val();





            $this.button('loading');
            var listingForm = $( "#list_form" );

            listingForm.validate({
                errorPlacement: function(){
                    return false;
                }


            });
            var validationState = listingForm.valid();

            if(validationState) {

                $.ajax(
                    {
                        url: '/api/listing',
                        type: 'POST',
                        contentType: "application/json",
                        dataType: "json",
                        headers: {'Api-Token': token},
                        data:  JSON.stringify({
                            name: lista,
                            type: tipo,
                            description: descricao
                        }),
                        success: function (response) {
                            console.log(response);
                            $('#listing-datatable').DataTable().ajax.reload()
                            $this.button('reset');
                            $('#listingModal').modal('toggle');
                            $("#list_form").trigger("reset")
                        },
                        error: function (error) {
                            alert(error.responseJSON.error.exception["0"].message);
                            $this.button('reset');
                            $('#listingModal').modal('toggle');
                            $("#list_form").trigger("reset")
                        }

                    }).done(function () {
                    $this.button('reset');
                });
            }else{
                $this.button('reset');
            }

        });


        //select all function
        selectAll("selectAllListing","chkListing");
        // END LISTING TABLE

        // BEGIN PRODUCTS TABLE
        $('#product-datatable').dataTable({
            language: {


                "sEmptyTable": "Nenhum registro encontrado",
                "sInfo": "Mostrando de _START_ até _END_ de _TOTAL_ registros",
                "sInfoEmpty": "Mostrando 0 até 0 de 0 registros",
                "sInfoFiltered": "(Filtrados de _MAX_ registros)",
                "sInfoPostFix": "",
                "sInfoThousands": ".",
                "sLengthMenu": "_MENU_ resultados por página",
                "sLoadingRecords": "Carregando...",
                "sProcessing": "Processando...",
                "sZeroRecords": "Nenhum registro encontrado",
                "sSearch": "Pesquisar",
                "oPaginate": {
                    "sNext": '<i class="fa fa-angle-right"></i>',
                    "sPrevious": '<i class="fa fa-angle-left"></i>',

                },
                "oAria": {
                    "sSortAscending": ": Ordenar colunas de forma ascendente",
                    "sSortDescending": ": Ordenar colunas de forma descendente"
                }
            },
            ajax: {
                url: "/api/product",
                type: 'GET',
               dataSrc: "",
                beforeSend : function(xhr) {
                    xhr.setRequestHeader('Api-Token', token);
                }
            },
            columns: [
                    { "data": "id" },
                    { "data": "name" },
                    { "data": "type" },
                    { "data": "brand"},
                    { "data": "unit"},
                    { "data": "id",
                        "orderable": false ,
                        "className": "dt-center",
                        "render": function ( data, type, row ) {
                            return '<label class="mt-checkbox mt-checkbox-outline"/>  <input type="checkbox" name="chkProducts" value="' + data + '"  /> <span></span>';
                        }
                }

            ],
            dom: '<"top"<"pull-left"l><"pull-right"fB>>t<"bottom"ip><"clear">',
            buttons: [
                {
                    text: '',
                    className: 'datatable-plus-button ',
                    action: function ( e, dt, node, config ) {
                        $('#productModal').modal('toggle');
                    }
                }
            ]
        } );
        /*
         product_form
         produto
         marca
         tipo-produto
         codigo

         unidade
         peso
         descricao-produto


         */

        $('#salvar_produto').on('click', function() {



            var $this = $(this);

            var produto = $('#produto').val();
            var marca = $('#marca').val();
            var tipo = $('#tipo-produto').val();
            var codigo = $('#codigo').val();
            var unidade = $('#unidade').val();;
            var peso = $('#peso').val();
            var descricao = $('#descricao-produto').val();;


            $this.button('loading');
            var productForm = $( "#product_form" );

            productForm.validate({
                errorPlacement: function(){
                    return false;
                }


            });
            var validationState = productForm.valid();

            if(validationState) {

                $.ajax(
                    {
                        url: '/api/product',
                        type: 'POST',
                        contentType: "application/json",
                        dataType: "json",
                        headers: {'Api-Token': token},
                        data:  JSON.stringify({
                            name: produto,
                            brand: marca,
                            type: tipo,
                            ean: codigo,
                            full_description: descricao,
                            quantity: peso,
                            unit: unidade
                        }),
                        success: function (response) {
                            console.log(response);
                            $('#product-datatable').DataTable().ajax.reload();
                            $this.button('reset');
                            $('#productModal').modal('toggle');
                            $("#product_form").trigger("reset")

                        },
                        error: function (error) {
                            alert(error.responseJSON.error.exception["0"].message);
                            $this.button('reset');
                            $('#productModal').modal('toggle');
                            $("#product_form").trigger("reset")
                        }

                    }).done(function () {
                    $this.button('reset');
                });
            }else{
                $this.button('reset');
            }

        });
        //select all function
        selectAll("selectAllProducts","chkProducts");

        // END PRODUCTS TABLE
    </script>
{% endblock %}
